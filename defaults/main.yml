---
# Enable ssh config hardening
system_security_ssh_enabled: true

# Possible SSHd service names
system_security_ssh_services: ["sshd", "ssh"]

# ssh port
system_security_ssh_port: 22

# Allow TCP forwarding: true - allow, false - block
system_security_ssh_allow_tcp_forwarding: false

# AcceptEnv value
system_security_ssh_accept_env: "LANG LC_*"

# Allow stream local forwarding: true - allow, false - block
system_security_ssh_allow_stream_local_forwarding: false

# AuthorizedKeysFile path
system_security_ssh_authorized_keys_file: ".ssh/authorized_keys /var/ssh/%u"

# ChallengeResponseAuthentication: true - allow, false - block
system_security_ssh_challenge_response_authentication: false

# ClientAliveInterval value (seconds)
system_security_ssh_client_alive_interval: 120

# LoginGraceTime value (seconds)
system_security_ssh_login_grace_time: 0

# Compression: true - allow, false - block
system_security_ssh_compression: false

# GatewayPorts: true - allow, false - block
system_security_ssh_gateway_ports: false

# IgnoreRhosts: true - allow, false - block
system_security_ssh_ignore_rhosts: true

# MaxAuthTries value
system_security_ssh_max_auth_tries: 3

# ssh password auth: true - allow, false - block
# (old variable name kept for backward compatibility)
system_security_ssh_passwordauth: false
system_security_ssh_password_authentication: "{{ system_security_ssh_passwordauth }}"

# PermitEmptyPasswords: true - allow, false - block
system_security_ssh_permit_empty_passwords: false

# ssh root login: true - allow, false - block
# (old variable name kept for backward compatibility)
system_security_ssh_rootlogin: true
system_security_ssh_permit_root_login: "{{ system_security_ssh_rootlogin }}"

# PermitTunnel: true - allow, false - block
system_security_ssh_permit_tunnel: false

# PrintLastLog: true - allow, false - block
system_security_ssh_print_last_log: true

# PrintMotd: true - allow, false - block
system_security_ssh_print_motd: false

# PubkeyAuthentication: true - allow, false - block
system_security_ssh_pubkey_authentication: true

# sftp server path
system_security_ssh_sftp_server: "/usr/lib/openssh/sftp-server"

# UseDNS: true - allow, false - block
system_security_ssh_use_dns: false

# UsePAM: true - allow, false - block
system_security_ssh_use_pam: true

# X11Forwarding: true - allow, false - block
system_security_ssh_x11_forwarding: false

# (intended for group vars) list of public ssh keys, allowed to connect to the server
system_security_ssh_authorizedkeys_auto: []

# (intended for host vars) list of public ssh keys, allowed to connect to the server
system_security_ssh_authorizedkeys_host: []

# list of public ssh keys, allowed to connect to the server
# note: for host vars, use system_security_ssh_authorizedkeys_host
# note: for group vars, use system_security_ssh_authorizedkeys_auto
system_security_ssh_authorizedkeys: "{{ system_security_ssh_authorizedkeys_auto + system_security_ssh_authorizedkeys_host }}"

# (intended for group vars) list of public ssh keys to revoke (remove) from .ssh/authorized_keys
system_security_ssh_unauthorizedkeys_auto: []

# (intended for host vars) list of public ssh keys to revoke (remove) from .ssh/authorized_keys
system_security_ssh_unauthorizedkeys_host: []

# list of public ssh keys to revoke (remove) from .ssh/authorized_keys
# note: for host vars, use system_security_ssh_unauthorizedkeys_host
# note: for group vars, use system_security_ssh_unauthorizedkeys_auto
system_security_ssh_unauthorizedkeys: "{{ system_security_ssh_unauthorizedkeys_auto + system_security_ssh_unauthorizedkeys_host }}"

# Additional configuration variables to pass to the sshd config
#
# Example:
# system_security_ssh_extension: |
#   Key value
system_security_ssh_extension: ''
